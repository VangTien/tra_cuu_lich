async function getAllHolidays() {
    const year = document.getElementById("yearInput").value.trim();
    const filter = document.getElementById("holidayFilter").value;
    if (!/^\d+$/.test(year)) {
        alert("Vui lòng nhập một năm hợp lệ!");
        return;
    }

    const resultsContainer = document.getElementById("results");
    resultsContainer.innerHTML = "";

    const traditionalHolidays = getTraditionalHolidays(year);
    const currentDate = new Date();
    const totalDays = getDaysInYear(Number(year));

    const daysInYearDiv = document.createElement("div");
    daysInYearDiv.className = "holiday-card";
    daysInYearDiv.innerHTML = ` 
        <div class="holiday-details">
            <div class="date-info">📆 Năm ${year} có tổng cộng: ${totalDays} ngày</div>
        </div>
    `;
    resultsContainer.appendChild(daysInYearDiv);

    try {
        const response = await fetch(`https://date.nager.at/api/v3/PublicHolidays/${year}/VN`);
        const publicHolidays = response.ok ? await response.json() : [];
        const importantHolidays = ["Tết Nguyên Đán", "Ngày Quốc Khánh Việt Nam"];
        
        // Kết hợp các ngày lễ, đảm bảo không bị trùng lặp
        const allHolidays = [...publicHolidays, ...traditionalHolidays];
        
        // Lọc ngày lễ trùng lặp theo tên
        const uniqueHolidays = allHolidays.filter((holiday, index, self) => 
            index === self.findIndex((t) => (
                t.localName === holiday.localName && t.date === holiday.date
            ))
        );

        uniqueHolidays.forEach(holiday => {
            const date = new Date(holiday.date);
            const gregorianDate = date.toLocaleDateString("vi-VN", {
                weekday: "long",
                day: "2-digit",
                month: "2-digit",
                year: "numeric"
            });
            const lunarDate = convertToLunarDate(date);
            const daysRemaining = Math.ceil((date - currentDate) / (1000 * 60 * 60 * 24));
            const isImportant = importantHolidays.includes(holiday.localName);

            if (daysRemaining <= 0) {
                return;
            }

            // Lọc ngày lễ theo loại
            if (filter !== 'all' && (filter === 'important' && !isImportant) || (filter === 'traditional' && isImportant)) {
                return;
            }

            const holidayDiv = document.createElement("div");
            holidayDiv.className = `holiday-card ${isImportant ? 'important-holiday' : ''}`;
            holidayDiv.innerHTML = `
                <div class="holiday-details">
                    <div class="date-info">📅 ${gregorianDate} (Âm lịch: ${lunarDate})</div>
                    <div class="name-info">🎉 ${holiday.localName}</div>
                    <div class="countdown-info">⏳ Còn ${daysRemaining} ngày</div>
                </div>
                <div class="description-info">📖 ${holiday.description || "Không có mô tả."}</div>
            `;
            resultsContainer.appendChild(holidayDiv);
        });
    } catch (error) {
        alert(`Lỗi kết nối: ${error.message}`);
    }
}
